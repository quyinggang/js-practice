<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>太阳系</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
      }
      #canvas {
        border: 1px solid #ddd;
        background-color: #000;
      }
    </style>
  </head>
  <body>
    <canvas id="canvas" width="800" height="600"></canvas>
    <script>
      const canvasElement = document.getElementById('canvas');
      const ctx = canvasElement.getContext('2d');

      const sunImage = new Image();
      const moonImage = new Image();
      const earthImage = new Image();

      const renderFrame = () => {
        const time = new Date();

        ctx.save();
        ctx.translate(400, 300);

        ctx.save();
        ctx.strokeStyle = "rgba(0,153,255,0.4)";
        ctx.beginPath();
        ctx.arc(0, 0, 225, 0, Math.PI * 2);
        ctx.stroke();
        ctx.closePath();
        ctx.restore();

        ctx.save();
        ctx.rotate(
          ((2 * Math.PI) / 60) * time.getSeconds() +
            ((2 * Math.PI) / 60000) * time.getMilliseconds()
        );
        ctx.drawImage(earthImage, 200, 0, 50, 50);

        ctx.translate(225, 25);
        ctx.rotate(
          ((2 * Math.PI) / 6) * time.getSeconds() +
            ((2 * Math.PI) / 6000) * time.getMilliseconds()
        );
        ctx.drawImage(moonImage, 40, 0, 10, 10);
        ctx.restore();

        ctx.drawImage(sunImage, -50, -50, 100, 100);

        ctx.restore();
      };

      const render = () => {
        requestAnimationFrame(render);
        ctx.clearRect(0, 0, 800, 600);
        renderFrame();
      };

      const init = () => {
        sunImage.src = "./images/sun.png";
        moonImage.src = "./images/moon.png";
        earthImage.src = "./images/earth.png";
        // 简单处理，延迟等待图片加载完毕
        setTimeout(render, 1000);
      };

      init();
    </script>
  </body>
</html>
