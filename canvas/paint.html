<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>简易画板</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
      }
      #canvas {
        width: 400px;
        height: 200px;
        border: 1px solid #ddd;
      }
      .group {
        display: flex;
        align-items: center;
      }
      #colorPicker,
      button:not(:first-child) {
        margin-left: 10px;
      }
    </style>
  </head>
  <body>
    <canvas id="canvas" width="1600" height="800"></canvas>
    <div class="group">
      <button id="bold">粗线条</button>
      <button id="tiny">细线条</button>
      <button id="save">保存签名</button>
      <input id="colorPicker" type="color" />
      <button id="erase">橡皮擦</button>
      <button id="clear">清空画布</button>
    </div>

    <script>
      const canvasElement = document.getElementById("canvas");
      const boldBtn = document.getElementById("bold");
      const tinyBtn = document.getElementById("tiny");
      const saveBtn = document.getElementById("save");
      const eraseBtn = document.getElementById("erase");
      const clearBtn = document.getElementById("clear");
      const colorPicker = document.getElementById("colorPicker");
      const ctx = canvasElement.getContext("2d");
      ctx.scale(4, 4);

      let isDrawing = false;

      colorPicker.addEventListener("change", (event) => {
        const color = event.target.value || "#000";
        ctx.strokeStyle = color;
      });
      boldBtn.addEventListener("click", () => {
        ctx.globalCompositeOperation = 'source-over';
        ctx.lineWidth = 5;
      });
      tinyBtn.addEventListener("click", () => {
        ctx.globalCompositeOperation = 'source-over';
        ctx.lineWidth = 1;
      });
      eraseBtn.addEventListener("click", () => {
        ctx.globalCompositeOperation = 'destination-out';
        ctx.lineWidth = 30;
      });
      clearBtn.addEventListener("click", () => {
        ctx.clearRect(0, 0, 400, 200);
      });
      saveBtn.addEventListener("click", () => {
        const url = canvasElement.toDataURL();
        let link = document.createElement("a");
        link.href = url;
        link.download = `签名-${Date.now()}.png`;
        link.click();
        link = null;
      });

      canvasElement.onmousedown = (event) => {
        isDrawing = true;
        const x = event.pageX;
        const y = event.pageY;
        ctx.beginPath();
        ctx.moveTo(x, y);
      };
      canvasElement.onmousemove = (event) => {
        if (!isDrawing) return
        const x = event.pageX;
        const y = event.pageY;
        ctx.lineTo(x, y);
        ctx.stroke();
      };
      canvasElement.onmouseup = () => {
        isDrawing = false;
        ctx.closePath();
      };
      canvasElement.onmouseleave = () => {
        isDrawing = false;
        ctx.closePath();
      }
    </script>
  </body>
</html>
